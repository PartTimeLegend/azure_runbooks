{
  "version": 4,
  "terraform_version": "1.0.0",
  "serial": 68,
  "lineage": "8178979b-d933-db11-f1d4-73775fd2e88d",
  "outputs": {
    "automation_account_name": {
      "value": "aaa-automation-uks",
      "type": "string"
    },
    "location": {
      "value": "uks",
      "type": "string"
    },
    "resource_group_name": {
      "value": "rg-automation-uks",
      "type": "string"
    },
    "service_principal": {
      "value": "aaa-automation-uks_6velBtylq6fBre9U",
      "type": "string"
    },
    "tmp_runbook_name": {
      "value": "rb-remove-tmp-resources-uks",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "2021-06-14 16:35:22.186228 +0000 UTC",
            "object_id": "e8fc849e-1585-4616-abe6-159ca7d02327",
            "subscription_id": "368a5462-8c33-4742-92ef-4284072f11fb",
            "tenant_id": "f71b6bca-ed76-45ef-a95c-e504b6cec63c",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_subscription",
      "name": "primary",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "display_name": "Azure DevTest",
            "id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb",
            "location_placement_id": "Public_2014-09-01",
            "quota_id": "MSDNDevTest_2014-09-01",
            "spending_limit": "Off",
            "state": "Enabled",
            "subscription_id": "368a5462-8c33-4742-92ef-4284072f11fb",
            "tags": {},
            "tenant_id": "f71b6bca-ed76-45ef-a95c-e504b6cec63c",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "local_file",
      "name": "tmp_runbook_powershell",
      "provider": "provider[\"registry.terraform.io/hashicorp/local\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content": "$connectionName = \"AzureRunAsConnection\"\r\ntry\r\n{\r\n    # Get the connection \"AzureRunAsConnection \"\r\n\r\n    $servicePrincipalConnection = Get-AutomationConnection -Name $connectionName\r\n\r\n    \"Logging in to Azure...\"\r\n    $connectionResult =  Connect-AzAccount -Tenant $servicePrincipalConnection.TenantID `\r\n                             -ApplicationId $servicePrincipalConnection.ApplicationID   `\r\n                             -CertificateThumbprint $servicePrincipalConnection.CertificateThumbprint `\r\n                             -ServicePrincipal\r\n    \"Logged in.\"\r\n\r\n}\r\ncatch {\r\n    if (!$servicePrincipalConnection)\r\n    {\r\n        $ErrorMessage = \"Connection $connectionName not found.\"\r\n        throw $ErrorMessage\r\n    } else{\r\n        Write-Error -Message $_.Exception\r\n        throw $_.Exception\r\n    }\r\n}\r\nGet-AzResource -Name *tmp-uks* | Remove-AzResource -Force",
            "content_base64": "JGNvbm5lY3Rpb25OYW1lID0gIkF6dXJlUnVuQXNDb25uZWN0aW9uIg0KdHJ5DQp7DQogICAgIyBHZXQgdGhlIGNvbm5lY3Rpb24gIkF6dXJlUnVuQXNDb25uZWN0aW9uICINCg0KICAgICRzZXJ2aWNlUHJpbmNpcGFsQ29ubmVjdGlvbiA9IEdldC1BdXRvbWF0aW9uQ29ubmVjdGlvbiAtTmFtZSAkY29ubmVjdGlvbk5hbWUNCg0KICAgICJMb2dnaW5nIGluIHRvIEF6dXJlLi4uIg0KICAgICRjb25uZWN0aW9uUmVzdWx0ID0gIENvbm5lY3QtQXpBY2NvdW50IC1UZW5hbnQgJHNlcnZpY2VQcmluY2lwYWxDb25uZWN0aW9uLlRlbmFudElEIGANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLUFwcGxpY2F0aW9uSWQgJHNlcnZpY2VQcmluY2lwYWxDb25uZWN0aW9uLkFwcGxpY2F0aW9uSUQgICBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1DZXJ0aWZpY2F0ZVRodW1icHJpbnQgJHNlcnZpY2VQcmluY2lwYWxDb25uZWN0aW9uLkNlcnRpZmljYXRlVGh1bWJwcmludCBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1TZXJ2aWNlUHJpbmNpcGFsDQogICAgIkxvZ2dlZCBpbi4iDQoNCn0NCmNhdGNoIHsNCiAgICBpZiAoISRzZXJ2aWNlUHJpbmNpcGFsQ29ubmVjdGlvbikNCiAgICB7DQogICAgICAgICRFcnJvck1lc3NhZ2UgPSAiQ29ubmVjdGlvbiAkY29ubmVjdGlvbk5hbWUgbm90IGZvdW5kLiINCiAgICAgICAgdGhyb3cgJEVycm9yTWVzc2FnZQ0KICAgIH0gZWxzZXsNCiAgICAgICAgV3JpdGUtRXJyb3IgLU1lc3NhZ2UgJF8uRXhjZXB0aW9uDQogICAgICAgIHRocm93ICRfLkV4Y2VwdGlvbg0KICAgIH0NCn0NCkdldC1BelJlc291cmNlIC1OYW1lICp0bXAtdWtzKiB8IFJlbW92ZS1BelJlc291cmNlIC1Gb3JjZQ==",
            "filename": "../RemoveTmpResources.ps1",
            "id": "6a18f817d35d5a534606b51e5897ac686506f29f"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azuread_application",
      "name": "ad_application",
      "provider": "provider[\"registry.terraform.io/hashicorp/azuread\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "api": [
              {
                "oauth2_permission_scope": [
                  {
                    "admin_consent_description": "Allow the application to access aaa-automation-uks_6velBtylq6fBre9U on behalf of the signed-in user.",
                    "admin_consent_display_name": "Access aaa-automation-uks_6velBtylq6fBre9U",
                    "enabled": true,
                    "id": "eca43fcb-ba91-4b9e-9285-e998bdd76535",
                    "type": "User",
                    "user_consent_description": "Allow the application to access aaa-automation-uks_6velBtylq6fBre9U on your behalf.",
                    "user_consent_display_name": "Access aaa-automation-uks_6velBtylq6fBre9U",
                    "value": "user_impersonation"
                  }
                ]
              }
            ],
            "app_role": [],
            "application_id": "1537cb6c-af58-4607-9ba8-be4b81ea9e30",
            "available_to_other_tenants": false,
            "display_name": "aaa-automation-uks_6velBtylq6fBre9U",
            "fallback_public_client_enabled": false,
            "group_membership_claims": "",
            "homepage": "",
            "id": "fed5ab5b-62a8-452a-bc5b-7f4ded0f1f74",
            "identifier_uris": [],
            "logout_url": "",
            "name": "aaa-automation-uks_6velBtylq6fBre9U",
            "oauth2_allow_implicit_flow": false,
            "oauth2_permissions": [
              {
                "admin_consent_description": "Allow the application to access aaa-automation-uks_6velBtylq6fBre9U on behalf of the signed-in user.",
                "admin_consent_display_name": "Access aaa-automation-uks_6velBtylq6fBre9U",
                "id": "eca43fcb-ba91-4b9e-9285-e998bdd76535",
                "is_enabled": true,
                "type": "User",
                "user_consent_description": "Allow the application to access aaa-automation-uks_6velBtylq6fBre9U on your behalf.",
                "user_consent_display_name": "Access aaa-automation-uks_6velBtylq6fBre9U",
                "value": "user_impersonation"
              }
            ],
            "object_id": "fed5ab5b-62a8-452a-bc5b-7f4ded0f1f74",
            "optional_claims": [],
            "owners": [
              "e8fc849e-1585-4616-abe6-159ca7d02327"
            ],
            "prevent_duplicate_names": false,
            "public_client": false,
            "reply_urls": [],
            "required_resource_access": [],
            "sign_in_audience": "AzureADMyOrg",
            "timeouts": null,
            "type": "webapp/api",
            "web": [
              {
                "homepage_url": "",
                "implicit_grant": [
                  {
                    "access_token_issuance_enabled": false
                  }
                ],
                "logout_url": "",
                "redirect_uris": []
              }
            ]
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJyZWFkIjozMDAwMDAwMDAwMDAsInVwZGF0ZSI6MzAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_automation_account.automation_account",
            "azurerm_resource_group.rgautomation",
            "random_string.random"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azuread_application_certificate",
      "name": "application_certificate",
      "provider": "provider[\"registry.terraform.io/hashicorp/azuread\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_object_id": "fed5ab5b-62a8-452a-bc5b-7f4ded0f1f74",
            "encoding": "pem",
            "end_date": "2021-06-14T16:23:21Z",
            "end_date_relative": null,
            "id": "fed5ab5b-62a8-452a-bc5b-7f4ded0f1f74/certificate/0a4bd9fb-cdba-1e1f-61f2-651eaa47c8e0",
            "key_id": "0a4bd9fb-cdba-1e1f-61f2-651eaa47c8e0",
            "start_date": "2021-06-14T15:29:26Z",
            "type": "AsymmetricX509Cert",
            "value": "-----BEGIN CERTIFICATE-----\r\nMIIEFzCCAv+gAwIBAgIUJo+IhsM+izGeqbpfw7L2UmJ2vEQwDQYJKoZIhvcNAQEL\r\nBQAwgZoxCzAJBgNVBAYTAlVLMQ8wDQYDVQQIDAZMb25kb24xDzANBgNVBAcMBkxv\r\nbmRvbjEZMBcGA1UECgwQQ2xvdWRib29raW5nIEx0ZDEfMB0GA1UEAwwWcnVuYXMt\r\nc2VydmljZXByaW5jaXBhbDEtMCsGCSqGSIb3DQEJARYeYW50b255LmJhaWxleUBj\r\nbG91ZGJvb2tpbmcuY29tMB4XDTIxMDYxNDE1MjkyNloXDTIyMDYxNDE1MjkyNlow\r\ngZoxCzAJBgNVBAYTAlVLMQ8wDQYDVQQIDAZMb25kb24xDzANBgNVBAcMBkxvbmRv\r\nbjEZMBcGA1UECgwQQ2xvdWRib29raW5nIEx0ZDEfMB0GA1UEAwwWcnVuYXMtc2Vy\r\ndmljZXByaW5jaXBhbDEtMCsGCSqGSIb3DQEJARYeYW50b255LmJhaWxleUBjbG91\r\nZGJvb2tpbmcuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzxRF\r\nWOA13f2ZFiXnIpYS6nomHGf74TI/mSGubowk/OVb0NcrOIQrH7Mo6a1VV2dKPM2J\r\nUMhK3wkQBTkjf4scW3trAMpt8x6H8SS7X+Gd0C1Mz5Hs6uXRZXkUF8A+W5+oGKP1\r\nYVuIWSBy5AFJJBNg7gwtrqd77f9hqGEqBM+Wp9r48AFnXMgsfWKAD2IptxV4jBdQ\r\nP9EsiB5k0oKKHL9A37fccg8DT+rPOnszphFutIWV9FF0f2vNb1rqqT5y9/DGfBC8\r\nZL9XM3BBapZUIXtr/f7o8UYhMFAYplKpGcPfvPH0lmVfY4OrzA4IpDOfLkB2h4jz\r\nIibli/stqiZpyf5UmQIDAQABo1MwUTAdBgNVHQ4EFgQUh9MDTzsh+lWsZwahMbzS\r\ne+MxmWowHwYDVR0jBBgwFoAUh9MDTzsh+lWsZwahMbzSe+MxmWowDwYDVR0TAQH/\r\nBAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEARW9xvQGMi2/Knc1TUYyNM4dNwBaz\r\nwr2+9foasHHBBczn1ZAkDGToJwgg2tjGdW0O5BpePlodn9+mcGKqny3lJt3ce3pH\r\nwWRLS0ZHslYRn6D945uKHxyb36RtiW1hAsOYbQmv7TVM1aFtXCqJxUMROGDWFAaE\r\naoOhCgGJFIe4mTvYqE5mnD/PmKPkUpfX573DgoSrhvfkb2Et0CTzFn49Uu5q8fX6\r\nP3NgDdRWqCD6seCOawK+mUMW+WCec0TP5VwbSnk+PwmplgS61oyB8W3wjkZnsY/s\r\nJY+GT+2R9n7AoylrQOfynqZ/hMUUTgnJbMUWSOBJsXsyj+zktxgUM9uTGw==\r\n-----END CERTIFICATE-----\r\n"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "azuread_application.ad_application",
            "azurerm_automation_account.automation_account",
            "azurerm_resource_group.rgautomation",
            "random_string.random"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azuread_service_principal",
      "name": "service_principal",
      "provider": "provider[\"registry.terraform.io/hashicorp/azuread\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "app_role_assignment_required": false,
            "app_roles": [],
            "application_id": "1537cb6c-af58-4607-9ba8-be4b81ea9e30",
            "display_name": "aaa-automation-uks_6velBtylq6fBre9U",
            "id": "dd4239a0-5c71-41e5-a5b9-f486e6434a04",
            "oauth2_permission_scopes": [
              {
                "admin_consent_description": "Allow the application to access aaa-automation-uks_6velBtylq6fBre9U on behalf of the signed-in user.",
                "admin_consent_display_name": "Access aaa-automation-uks_6velBtylq6fBre9U",
                "enabled": true,
                "id": "eca43fcb-ba91-4b9e-9285-e998bdd76535",
                "type": "User",
                "user_consent_description": "Allow the application to access aaa-automation-uks_6velBtylq6fBre9U on your behalf.",
                "user_consent_display_name": "Access aaa-automation-uks_6velBtylq6fBre9U",
                "value": "user_impersonation"
              }
            ],
            "oauth2_permissions": [
              {
                "admin_consent_description": "Allow the application to access aaa-automation-uks_6velBtylq6fBre9U on behalf of the signed-in user.",
                "admin_consent_display_name": "Access aaa-automation-uks_6velBtylq6fBre9U",
                "id": "eca43fcb-ba91-4b9e-9285-e998bdd76535",
                "is_enabled": true,
                "type": "User",
                "user_consent_description": "Allow the application to access aaa-automation-uks_6velBtylq6fBre9U on your behalf.",
                "user_consent_display_name": "Access aaa-automation-uks_6velBtylq6fBre9U",
                "value": "user_impersonation"
              }
            ],
            "object_id": "dd4239a0-5c71-41e5-a5b9-f486e6434a04",
            "tags": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "azuread_application.ad_application",
            "azuread_application_certificate.application_certificate",
            "azurerm_automation_account.automation_account",
            "azurerm_resource_group.rgautomation",
            "random_string.random"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_automation_account",
      "name": "automation_account",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "dsc_primary_access_key": "IvnvmuEp6LNbLbG+JKJdzlCZmEfGXaGS6tzXXIPP3FuAKNoZUjQtNdEp6A00ycD9iXjHkzCGiA4TTRssb2YgsQ==",
            "dsc_secondary_access_key": "NOmwIrs3jYgEx8LTtYfRNW+s0KJsZToSvmJgg9l9ujbAfiBjgcQwj2r5EWohKRp5OROhhOcTW2yXyKlgaL39PQ==",
            "dsc_server_endpoint": "https://9d99fcb0-3b2d-45fe-a941-de8579436941.agentsvc.uks.azure-automation.net/accounts/9d99fcb0-3b2d-45fe-a941-de8579436941",
            "id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb/resourceGroups/rg-automation-uks/providers/Microsoft.Automation/automationAccounts/aaa-automation-uks",
            "location": "uksouth",
            "name": "aaa-automation-uks",
            "resource_group_name": "rg-automation-uks",
            "sku_name": "Basic",
            "tags": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_resource_group.rgautomation"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_automation_certificate",
      "name": "automation_certificate",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "automation_account_name": "aaa-automation-uks",
            "base64": "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",
            "description": "",
            "exportable": false,
            "id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb/resourceGroups/rg-automation-uks/providers/Microsoft.Automation/automationAccounts/aaa-automation-uks/certificates/AzureRunAsCertificate",
            "name": "AzureRunAsCertificate",
            "resource_group_name": "rg-automation-uks",
            "thumbprint": "46853CB4A6BD5493A76FD70BCBB456040180BD60",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_automation_account.automation_account",
            "azurerm_resource_group.rgautomation"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_automation_connection_service_principal",
      "name": "test",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_id": "1537cb6c-af58-4607-9ba8-be4b81ea9e30",
            "automation_account_name": "aaa-automation-uks",
            "certificate_thumbprint": "46853CB4A6BD5493A76FD70BCBB456040180BD60",
            "description": "",
            "id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb/resourceGroups/rg-automation-uks/providers/Microsoft.Automation/automationAccounts/aaa-automation-uks/connections/AzureRunAsConnection",
            "name": "AzureRunAsConnection",
            "resource_group_name": "rg-automation-uks",
            "subscription_id": "368a5462-8c33-4742-92ef-4284072f11fb",
            "tenant_id": "f71b6bca-ed76-45ef-a95c-e504b6cec63c",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azuread_application.ad_application",
            "azuread_application_certificate.application_certificate",
            "azuread_service_principal.service_principal",
            "azurerm_automation_account.automation_account",
            "azurerm_automation_certificate.automation_certificate",
            "azurerm_resource_group.rgautomation",
            "data.azurerm_client_config.current",
            "random_string.random"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_automation_module",
      "name": "az_accounts",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "automation_account_name": "aaa-automation-uks",
            "id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb/resourceGroups/rg-automation-uks/providers/Microsoft.Automation/automationAccounts/aaa-automation-uks/modules/Az.Accounts",
            "module_link": [
              {
                "hash": [],
                "uri": "https://psg-prod-eastus.azureedge.net/packages/az.accounts.2.3.0.nupkg"
              }
            ],
            "name": "Az.Accounts",
            "resource_group_name": "rg-automation-uks",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_automation_account.automation_account",
            "azurerm_resource_group.rgautomation"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_automation_module",
      "name": "az_resources",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "automation_account_name": "aaa-automation-uks",
            "id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb/resourceGroups/rg-automation-uks/providers/Microsoft.Automation/automationAccounts/aaa-automation-uks/modules/Az.Resources",
            "module_link": [
              {
                "hash": [],
                "uri": "https://psg-prod-eastus.azureedge.net/packages/az.resources.4.1.1.nupkg"
              }
            ],
            "name": "Az.Resources",
            "resource_group_name": "rg-automation-uks",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_automation_account.automation_account",
            "azurerm_automation_module.az_accounts",
            "azurerm_resource_group.rgautomation"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_automation_runbook",
      "name": "tmp_automation_runbook",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "automation_account_name": "aaa-automation-uks",
            "content": "$connectionName = \"AzureRunAsConnection\"\r\ntry\r\n{\r\n    # Get the connection \"AzureRunAsConnection \"\r\n\r\n    $servicePrincipalConnection = Get-AutomationConnection -Name $connectionName\r\n\r\n    \"Logging in to Azure...\"\r\n    $connectionResult =  Connect-AzAccount -Tenant $servicePrincipalConnection.TenantID `\r\n                             -ApplicationId $servicePrincipalConnection.ApplicationID   `\r\n                             -CertificateThumbprint $servicePrincipalConnection.CertificateThumbprint `\r\n                             -ServicePrincipal\r\n    \"Logged in.\"\r\n\r\n}\r\ncatch {\r\n    if (!$servicePrincipalConnection)\r\n    {\r\n        $ErrorMessage = \"Connection $connectionName not found.\"\r\n        throw $ErrorMessage\r\n    } else{\r\n        Write-Error -Message $_.Exception\r\n        throw $_.Exception\r\n    }\r\n}\r\nGet-AzResource -Name *tmp-uks* | Remove-AzResource -Force",
            "description": "Removes Resources with tmp in name",
            "id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb/resourceGroups/rg-automation-uks/providers/Microsoft.Automation/automationAccounts/aaa-automation-uks/runbooks/rb-remove-tmp-resources-uks",
            "job_schedule": [],
            "location": "uksouth",
            "log_progress": true,
            "log_verbose": true,
            "name": "rb-remove-tmp-resources-uks",
            "publish_content_link": [
              {
                "hash": [],
                "uri": "https://www.microsoft.com",
                "version": ""
              }
            ],
            "resource_group_name": "rg-automation-uks",
            "runbook_type": "PowerShell",
            "tags": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_automation_account.automation_account",
            "azurerm_resource_group.rgautomation",
            "data.local_file.tmp_runbook_powershell"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "rgautomation",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb/resourceGroups/rg-automation-uks",
            "location": "uksouth",
            "name": "rg-automation-uks",
            "tags": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb/providers/Microsoft.Authorization/roleAssignments/68909563-1a40-5ea1-9e98-3e3002647964",
            "name": "68909563-1a40-5ea1-9e98-3e3002647964",
            "principal_id": "dd4239a0-5c71-41e5-a5b9-f486e6434a04",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/subscriptions/368a5462-8c33-4742-92ef-4284072f11fb",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azuread_application.ad_application",
            "azuread_application_certificate.application_certificate",
            "azuread_service_principal.service_principal",
            "azurerm_automation_account.automation_account",
            "azurerm_resource_group.rgautomation",
            "data.azurerm_subscription.primary",
            "random_string.random"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "random_string",
      "name": "random",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "id": "6velBtylq6fBre9U",
            "keepers": null,
            "length": 16,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "override_special": null,
            "result": "6velBtylq6fBre9U",
            "special": false,
            "upper": true
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    }
  ]
}
